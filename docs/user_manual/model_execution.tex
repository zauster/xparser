\section{Model Execution}

FLAME contains a parser program called `xparser' that parses a model
XML definition into simulation program source code that can be compiled
together with any model implementation source code. The xparser includes
template files which are used to generate the simulation program source code.

The xparser takes as parameters the location of the model file and an option
for serial or parallel (MPI) version, serial being the default if the option is
not specified.

The xparser then generates simulation source code files in the same directory
as the model file. These files include:

\begin{itemize}
  \item Doxyfile -- a configuration file for generating documentation using
 the program `doxygen'
  \item header.h -- a C header file for global variables and function
  declarations between source code files
  \item low\_primes.h -- holds data used for partitioning agents
  \item main.c -- the source code file containing the main program loop
  \item Makefile -- the compilation script used by the program `make'
  \item memory.c -- the source code file that handles the memory requirements
  of the simulation
  \item xml.c -- the source code file that handles inputs and outputs of the
  simulation
  \item <agent\_name>\_agent\_header.h -- the header file containing macros for
  accessing agent memory variables
  \item rules.c -- the source code file containing the generated rules for
  function conditions and message input filters
  \item messageboards.c -- depricated?
  \item partitioning.c -- still used?
\end{itemize}

and in parallel the additional files:

\begin{itemize}
  \item propagate\_messages.c -- depricated?
  \item propagate\_agents.c -- still used?
\end{itemize}

The simulation source code files then require compilation, which can be easily
acheived using the included compilation script `Makefile' using the `make'
build automation tool. The program `make' invokes the `gcc' C compiler, which
are both free and avaliable on various operating systems. If the parallel
version of the simulation was specified the compiler invoked by `make' is
`mpicc' which is a script usually avalible on parallel systems.

The compiled program is called `main'. The parameters required to run a
simulation include the number of iterations to run for and the initial start
states (memory) of the agents, currently a formatted XML file.

The format of the initial start states XML is given by the folowing example:

\begin{mylisting}
\begin{verbatim}
<states>
<itno>0</itno>

<environment>
<my_constant>6</my_constant>
</environment>

<xagent>
<name>agent_name</name>
<var_name>0</var_name>
...
</xagent>

...

</states>
\end{verbatim}
\end{mylisting}

The root tag is called `states' and the `itno' tag holds the iteration number
that these states refer to. If there are any environment constants these are
placed within the `environment' tags. Any agents that exist are defined within
`xagent' tags and require the name of the agent within `name' tags. Any agent
memory variable (or environment constant) value is defined within tags with
the name of the variable. Arrays and data types are defined within curly
brackets with commas between each element.

When a simulation is running after every iteration, a states file is produced
in the same directory and in the same format as the start states file with the
values of each agent's memory.
